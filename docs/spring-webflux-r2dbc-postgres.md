# Spring Postgres Migration

- We need to add the postgres R2DBC driver `org.postgresql`.`r2dbc-postgresql` in `pom.xml`
- Update the `spring.datasource.url` to `jdbc:postgresql://{dchost}:5432/{dbname}`
  - update the corresponding username and passwords if changing
- Most of the runtime queries here work out of the box
- Don't need to `mysql-init` file anymore when using the postgres container
- For setting autogenerated ids for table
  - we use `id serial primary key` in create table statement
  - here `serial` is the datatype like `int` or `varchar` generally used for auto-increment ids
- For postgres users
  - doesn't seem like they are host-specific
  - providing grants also cannot be done by `*.*` and instead is `grant all on schema public`
  - you also cannot directly drop a user (or roles as they call it) and have to revoke all grants first
    - its hard to know what all it has grants to so generally we `reassign owned` to the default user
    - default user is `postgres` and can be set when the container is created
  - to actually create a new database and a new user
    - first create a new database with default user
    - then connect to this new database with default user and create the new user with required privileges
    - then connect to the new database with the new user and do the rest
  - Postgres also doesn't allow double quotes for strings so always use single-quotes
- For R2DBC speciifcally, we have to update the `AppConfig` where we provide a timezone related config for MySQL [CHECK-ISSUES]

---
